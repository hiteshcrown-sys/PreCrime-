import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useState } from "react";
import { motion } from "framer-motion";
import { Fingerprint, Clock, MapPin, TrendingUp, Target, Zap, RefreshCw } from "lucide-react";
import PatternCluster from "@/components/crimedna/PatternCluster";
import PatternTimeline from "@/components/crimedna/PatternTimeline";
import RiskBadge from "@/components/ui/RiskBadge";
import usePatternDetection from "@/hooks/usePatternDetection";
export default function CrimeDNA() {
    const [selectedPattern, setSelectedPattern] = useState(null);
    const { patterns, connections, loading, error, refreshPatterns, statistics } = usePatternDetection();
    return (_jsxs("div", { className: "space-y-6", children: [_jsxs("div", { children: [_jsxs("div", { className: "flex items-center justify-between mb-2", children: [_jsxs("div", { className: "flex items-center gap-3", children: [_jsx("div", { className: "p-2 rounded-lg bg-purple-500/20", children: _jsx(Fingerprint, { className: "w-6 h-6 text-purple-400" }) }), _jsxs("div", { children: [_jsx("h1", { className: "text-2xl font-bold text-white", children: "Crime DNA\u2122" }), _jsx("p", { className: "text-slate-400 text-sm", children: "Pattern Fingerprinting Engine" })] })] }), _jsx(motion.button, { onClick: refreshPatterns, disabled: loading, whileHover: { scale: 1.05 }, whileTap: { scale: 0.95 }, className: "p-2 rounded-lg bg-purple-500/20 hover:bg-purple-500/30 text-purple-400 disabled:opacity-50 transition-all", children: _jsx(RefreshCw, { className: `w-5 h-5 ${loading ? 'animate-spin' : ''}` }) })] }), !loading && patterns.length > 0 && (_jsxs("div", { className: "grid grid-cols-2 md:grid-cols-4 gap-3 mt-4", children: [_jsxs("div", { className: "bg-slate-800/50 rounded-lg p-3 border border-slate-700", children: [_jsx("p", { className: "text-xs text-slate-500 mb-1", children: "Total Patterns" }), _jsx("p", { className: "text-xl font-bold text-white", children: statistics.totalPatterns })] }), _jsxs("div", { className: "bg-slate-800/50 rounded-lg p-3 border border-slate-700", children: [_jsx("p", { className: "text-xs text-slate-500 mb-1", children: "Crime Types" }), _jsx("p", { className: "text-xl font-bold text-cyan-400", children: statistics.uniqueCrimeTypes })] }), _jsxs("div", { className: "bg-slate-800/50 rounded-lg p-3 border border-slate-700", children: [_jsx("p", { className: "text-xs text-slate-500 mb-1", children: "Avg Similarity" }), _jsxs("p", { className: "text-xl font-bold text-purple-400", children: [statistics.avgSimilarity, "%"] })] }), _jsxs("div", { className: "bg-slate-800/50 rounded-lg p-3 border border-slate-700", children: [_jsx("p", { className: "text-xs text-slate-500 mb-1", children: "Clusters" }), _jsx("p", { className: "text-xl font-bold text-orange-400", children: statistics.clusters })] })] })), error && (_jsx("div", { className: "mt-4 p-4 bg-red-500/10 border border-red-500/50 rounded-lg", children: _jsxs("p", { className: "text-sm text-red-400", children: ["Error loading patterns: ", error] }) }))] }), _jsxs("div", { className: "grid grid-cols-1 xl:grid-cols-3 gap-6", children: [_jsx("div", { className: "xl:col-span-2", children: _jsxs("div", { className: "rounded-2xl bg-slate-900/50 border border-slate-800 overflow-hidden", children: [_jsxs("div", { className: "p-4 border-b border-slate-800", children: [_jsx("h3", { className: "font-semibold text-white", children: "Pattern Cluster Visualization" }), _jsx("p", { className: "text-xs text-slate-500 mt-0.5", children: loading ? "Loading patterns..." : `Click on patterns to view details (${patterns.length} detected)` })] }), _jsx("div", { className: "p-4 h-[450px] relative", children: !loading && patterns.length > 0 ? (_jsx(PatternCluster, { patterns: patterns, connections: connections, onPatternSelect: setSelectedPattern, selectedPattern: selectedPattern })) : loading ? (_jsx("div", { className: "h-full flex items-center justify-center text-slate-500", children: _jsxs("div", { className: "flex flex-col items-center gap-3", children: [_jsx("div", { className: "w-8 h-8 border-2 border-purple-500/30 border-t-purple-500 rounded-full animate-spin" }), _jsx("p", { className: "text-sm", children: "Analyzing crime patterns..." })] }) })) : (_jsx("div", { className: "h-full flex items-center justify-center text-slate-500", children: _jsx("p", { className: "text-sm", children: "No patterns detected" }) })) })] }) }), _jsx("div", { className: "xl:col-span-1", children: _jsxs("div", { className: "rounded-2xl bg-slate-900/50 border border-slate-800 h-full", children: [_jsxs("div", { className: "p-4 border-b border-slate-800", children: [_jsx("h3", { className: "font-semibold text-white", children: "Pattern Analysis" }), _jsx("p", { className: "text-xs text-slate-500 mt-0.5", children: "ML-detected pattern details" })] }), _jsx("div", { className: "p-4", children: selectedPattern ? (_jsxs(motion.div, { initial: { opacity: 0, y: 10 }, animate: { opacity: 1, y: 0 }, className: "space-y-4", children: [_jsxs("div", { className: "bg-slate-800/50 rounded-xl p-4 border border-slate-700", children: [_jsxs("div", { className: "flex items-center justify-between mb-3", children: [_jsx("span", { className: "text-xs text-slate-400 uppercase tracking-wider", children: "Pattern ID" }), _jsx(RiskBadge, { level: selectedPattern.similarity >= 90 ? "critical" : selectedPattern.similarity >= 75 ? "high" : "medium", size: "sm" })] }), _jsx("p", { className: "text-2xl font-bold text-white", children: selectedPattern.id })] }), _jsxs("div", { className: "grid grid-cols-2 gap-3", children: [_jsxs("div", { className: "bg-slate-800/50 rounded-xl p-3 border border-slate-700", children: [_jsxs("div", { className: "flex items-center gap-2 mb-2", children: [_jsx(Target, { className: "w-4 h-4 text-cyan-400" }), _jsx("span", { className: "text-xs text-slate-400", children: "Similarity" })] }), _jsxs("p", { className: "text-xl font-bold text-cyan-400", children: [selectedPattern.similarity, "%"] })] }), _jsxs("div", { className: "bg-slate-800/50 rounded-xl p-3 border border-slate-700", children: [_jsxs("div", { className: "flex items-center gap-2 mb-2", children: [_jsx(Zap, { className: "w-4 h-4 text-orange-400" }), _jsx("span", { className: "text-xs text-slate-400", children: "Crime Type" })] }), _jsx("p", { className: "text-sm font-semibold text-white", children: selectedPattern.type })] })] }), _jsxs("div", { className: "bg-slate-800/50 rounded-xl p-4 border border-slate-700", children: [_jsxs("div", { className: "flex items-center gap-2 mb-3", children: [_jsx(Clock, { className: "w-4 h-4 text-purple-400" }), _jsx("span", { className: "text-xs text-slate-400 uppercase", children: "Time Window" })] }), _jsxs("div", { className: "space-y-2", children: [_jsxs("div", { className: "flex justify-between text-sm", children: [_jsx("span", { className: "text-slate-400", children: "Peak Hour" }), _jsxs("span", { className: "text-white font-medium", children: [String(selectedPattern.hour).padStart(2, '0'), ":00"] })] }), _jsxs("div", { className: "flex justify-between text-sm", children: [_jsx("span", { className: "text-slate-400", children: "Crime Density" }), _jsxs("span", { className: "text-white font-medium", children: [Math.round(selectedPattern.density), "%"] })] }), _jsxs("div", { className: "flex justify-between text-sm", children: [_jsx("span", { className: "text-slate-400", children: "Severity" }), _jsxs("span", { className: "text-white font-medium", children: [Math.round(selectedPattern.severity), "/100"] })] })] })] }), _jsxs("div", { className: "bg-slate-800/50 rounded-xl p-4 border border-slate-700", children: [_jsxs("div", { className: "flex items-center gap-2 mb-3", children: [_jsx(MapPin, { className: "w-4 h-4 text-green-400" }), _jsx("span", { className: "text-xs text-slate-400 uppercase", children: "Primary Zone" })] }), _jsx("div", { className: "flex flex-wrap gap-2", children: _jsx("span", { className: "px-3 py-1.5 text-sm bg-slate-700 rounded-lg text-slate-200 font-medium", children: selectedPattern.zone }) })] })] })) : (_jsxs("div", { className: "h-64 flex flex-col items-center justify-center text-slate-500", children: [_jsx(Fingerprint, { className: "w-12 h-12 mb-3 opacity-30" }), _jsx("p", { className: "text-sm", children: "Select a pattern to view details" })] })) })] }) })] }), _jsxs("div", { className: "rounded-2xl bg-slate-900/50 border border-slate-800 overflow-hidden", children: [_jsxs("div", { className: "p-4 border-b border-slate-800 flex items-center justify-between", children: [_jsxs("div", { children: [_jsx("h3", { className: "font-semibold text-white", children: "Pattern Evolution Timeline" }), _jsx("p", { className: "text-xs text-slate-500 mt-0.5", children: selectedPattern ? `Showing history for ${selectedPattern.id}` : "12-month pattern trend analysis" })] }), _jsxs("div", { className: "flex items-center gap-2 text-xs text-green-400", children: [_jsx(TrendingUp, { className: "w-4 h-4" }), _jsxs("span", { children: ["+", Math.round(15 + Math.random() * 30), "% trend"] })] })] }), _jsx("div", { className: "p-6", children: selectedPattern ? (_jsx(PatternTimeline, { patternId: selectedPattern.id })) : (_jsx(PatternTimeline, { patternId: null })) })] })] }));
}
